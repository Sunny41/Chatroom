<!DOCTYPE>
<html>
    <head>
        <script src="/socket.io/socket.io.js"></script>
        <script>
            window.addEventListener("load", Ready); 
 
            function Ready(){ 
                if(window.File && window.FileReader){
                    document.getElementById('UploadButton').addEventListener('click', StartUpload);  
                    document.getElementById('FileBox').addEventListener('change', FileChosen);
                }
                else
                {
                    document.getElementById('UploadArea').innerHTML = "Your Browser Doesn't Support The File API Please Update Your Browser";
                }
            }

            var SelectedFile;
            function FileChosen(evnt) {
                SelectedFile = evnt.target.files[0];
                document.getElementById('NameBox').value = SelectedFile.name;
            }

            var socket = io.connect('http://localhost:3000');
            var FReader;
            var Name;
            function StartUpload(){
                if(document.getElementById('FileBox').value != "")
                {

                    var reader = new FileReader();
                        reader.onload = function(evt){
                            var msg ={};
                            msg.username = 'jannik';
                            msg.file = evt.target.result;
                            msg.fileName = document.getElementById('NameBox').value;
                            socket.emit('upload file', msg);
                        };
                        reader.readAsDataURL(SelectedFile);
                }
                else
                {
                    alert("Please Select A File");
                }
            }

            socket.on('send file', function (msg){
                var elem = document.createElement("img");
                elem.setAttribute("src", msg.file);
                elem.setAttribute("height", "240");
                elem.setAttribute("width", "240");
                elem.setAttribute("alt", "wolf");
                document.getElementById("image").appendChild(elem);
            });

        </script>
        

    </head>
    <body> 
        <div id="UploadBox">
            <h2>Video Uploader</h2>
            <span id='UploadArea'>
                <label for="FileBox">Choose A File: </label><input type="file" id="FileBox"><br>
                <label for="NameBox">Name: </label><input type="text" id="NameBox"><br>
     
                <button  type='button' id='UploadButton' class='Button'>Upload</button>
            </span>
        </div>

        <div id="image">
            
        </div>
    </body>
</html>